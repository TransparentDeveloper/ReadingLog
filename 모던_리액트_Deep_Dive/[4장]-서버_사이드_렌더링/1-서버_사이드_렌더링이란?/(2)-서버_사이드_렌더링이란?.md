# 서버 사이드 랜더링(SSR) 이란?

웹페이지의 로딩 시간이 길어지는 것에 대한 문제의식을 SPA 의 태생적 한계로 본다면, 서버에서 완성된 페이지를 제공하는 기존의 방식으로 이를 해결할 수 있다. 이러한 토대에서 SSR 방식이 다시 주목받기 시작했다.

SPA 와 SSR 의 차이는 랜더링의 책임을 어디에 두느냐에 있다. 
- SPA 는 사용자에게 제공된 JS 번들의 실행에 의해 랜더링이 이뤄진다. 
- SSR 의 경우 서버에서 랜더링에 필요한 작업을 수행한다. (랜더링 자체가 이뤄지는 건 아니다.)

<br/>

## SSR 의 장점

### 1️⃣ 최초 페이지 진입이 비교적 빠르다. (LCP 개선)

> **SPA**
>
> - 최초 진입 시에 페이지를 구성하는 모든 리소스를 다운로드해야 하기 때문에 최초 로딩시간이 길다.
> - 또한 외부 API 호출에 많이 의존하는 애플리케이션이라면, 최초에 사용자에게 보여줘야 할 화면이 완전히 구성되기 위해선 추가적인 시간이 필요하다.

> **SSR**
> 
> - 접근한 페이지에 대한 리소스만 확보한 뒤, HTML 을 그리고 전달하기 때문에 훨씬 빠르다.
> - HTTP 요청을 서버에서 수행하는 편이 더 빠르다.
> - 클라이언트에서 JS 실행을 통해 HTML 을 만들고 `<body>` 태그에 삽입하는 것보다, 서버에서 HTML 을 완성한 뒤 클라이언트에서는 그려만 주는게 더 빠르다.


단, 서버가 감당할 수 없을 정도로 요청이 과하거나 리소스 확보가 어렵다면 SPA 가 더 나은 선택지일 수 있다.

### 2️⃣ 검색엔진과 SNS 공유 등 메타데이터 제공이 쉽다. (SEO)

#### 검색엔진 로봇이 사이트에서 필요한 정볼를 가져가는 방법
1. 페이지 진입
2. HTML 다운로드 (JS 의 실행은 거의 일어나지 않는다.)
3. HTML 페이지에 설정된 OG 이미지나 메타 캐그 정보를 검색엔진에 저장한다.


**JS 의 실행 여부**는 굉장히 중요하다.

> **SPA**
>
> 일반적으로 JS 의 실행이 전제되어야 페이지 정보에 접근할 수 있다. (SEO 에 불리하다.)

> **SSR**
> 
> 서버에서 HTML 구성이 완료되었기 때문에, 검색엔진에 메타 정보를 제공할 수 있다.


### 3️⃣ 누적 레이아웃 이동이 적다. (CLS 개선)

> **SPA**
>
> 페이지 콘텐츠가 API 요청에 의존할수록, CLS 지표가 낮아질 가능성이 크다.
(API 요청의 응답 속도가 제각각이기 때문에 별도의 처리가 필요하다.)

> **SSR**
> 
> - API 요청을 서버에서 완료하기 때문에, 브라우저에서 페이지 콘텐츠가 출력되는 시점은 거의 동일하다.
> - (* 다만 API 응답 늦어질 경우, 사용자가 접근한 해당 페이지 전체가 안보일 수도 있다.)


### 4️⃣ 사용자의 디바이스 성능에 비교적 자유롭다.

실행 환경에 따라 JS 실행 시간이 다르다.

**SPA** 의 경우, 사용자의 디바이스 성능에 의존적이다.

**SSR** 방식이라면 랜더링 등 필요한 연산의 부담을 서버에서도 함께 부담할 수 있다.

(* 다만, 인터넷 속도가 느리다거나, 서버의 부담이 큰 상황이라면 SSR 방식도 느리다.)

### 5️⃣ 보안에 안전하다.

API 호출과 인증과 같은 작업 내용을 개발자 도구 등을 통해, 브라우저에 노출되는 것을 방지해야 한다.

**SSR** 방식을 통해, 민감한 작업은 서버에서 수행하고 그 결과만 브라우저에 제공할 수 있음으로 보안을 강화할 수 있다.

<br/>

## SSR 의 단점

### 1️⃣ 소스코드를 작성할 때, 항상 서버를 고려해야 한다.

window (브라우저 환경에서의 전역 객체) 나 web-storage 와 같이 브라우저 환경에서만 접근할 수 있는 코드가 포함되어 있다면 에러를 마주칠 것이다.

window 와 같은 객체를 이용해야 한다면 클라이언트에서 실행되도록 해야한다. (단, 클라이언트에서만 실행되는 코드가 많아질수록 SSR 의 장점을 잃게 된다.)

### 2️⃣ 적절한 서버가 구축돼 있어야 한다.

다음을 충족한 서버환경이 항상 준비되어 있어야 한다.

- 사용자 요청을 적절히 수용할 수 있는 물리적 가용량
- 예기치 않은 장애 상황에 대한 복구전략
- 요청을 분산시키기고, 예기치 못한 다운 상황을 대비한 프로세스 매니저

### 3️⃣ 서비스 지연에 따른 문제

SSR 에서 (어떤 이유에서건) 랜더링 지연이 발생할 경우, 사용자에게 이를 알릴 수단이 없다. (UX 악화)